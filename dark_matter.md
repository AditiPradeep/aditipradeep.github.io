---
title: ML reconstruction of SuperCDMS data
---

*Disclaimer: The amount of information in this page will be limited since I have restrictions on how much I can share before we publish the results. Once the results are published, I'll link the paper for more details.*

**The work described here was done entirely in python using LightGBM, scikit-learn, numpy, scipy and matplotlib. Initial tests were done with Tensorflow but the ensemble Gradient Boosted Decision tree model outperformed the Multi-layer perceptron for our data.** 

The idea is as follows:

SuperCDMS SNOLAB plans to use larger detectors divided into more number of channels/sections compared to previous versions of the experiment (see image below).

![SuperCDMS detector channel map]({{'/assets/img/CDMS_channel_map.png' | relative_url}})
*SuperCDMS detectors are partitioned into channels for efficient signal collection*

More number of channels means more ``cross-talk" between the channels which adds unwanted additional correlated noise, i.e., changes in one channel will affect the other channels. If not accounted for, this will deteriorate the performance of our energy estimators. Now imagine you are an incoming particle going to meet your friend, the recoiling nucleus of a Ge atom in the SuperCDMS detector. You arrive at your friend's home (the detector) but realize that your friend has just bought a bigger home. You walk to your friend and say hi. Now say the friend wants you to meet some of the guests (a signal collection mechanism) staying at his house. They call out to the guests from where they are. Because your friend's house is now bigger, their voice takes longer to reach the guests because the sound waves now take a longer time to propagate. The guest closest to your friend's location hears the call first, then the next one and so on. So the signals (vibrations in the crystal) are received or collected faster in channels (guest room) which are closer to the source. This is what we call 'position dependence' in SuperCDMS lingo. Position dependence can significantly degrade the energy resolution of the detector (the guest farthest from your friend may not hear what your friend said clearly).

The shape and height of the collected signal pulse depends on the location of the event and the height of the pulse also gives the amount of energy deposited in the crystal. SuperCDMS has developed an advanced fitting algorithm which fits multiple channels with multiple shapes or templates simultaneously to account for correlated noise, called the NxM filter. I found that, by using PCA, we can build templates which capture position information in the NxM output amplitudes. I also found that the application of machine learning can fix degradation from position dependence. Although my first attempt involved an MLP with the NxM amplitudes as input and the true energy as labels, I found it difficult to train the [MLP](https://en.wikipedia.org/wiki/Multilayer_perceptron) due to limited data sizes compared to the number of features. A machine learning scientist at TRIUMF, suggested [LightGBM](https://lightgbm.readthedocs.io/en/stable/) for my model due to its success in other particle physics applications. Using the LightGBM Gradient Boosted Decision Tree, I was able to obtain a factor of two improvement in energy resolution by correcting for position dependence. I was also able to reconstruct event locations in the detector by training on position labeled data. In the past, we often used the position dependent energy estimators obtained from various fitting algorithms (termed Optimal Filters or OFs in SuperCDMS which are matched filters) or the pulse rise times to construct some arbitrary quantity that correlates with position in some complicated way. The success in reconstructing position with ML was quite exciting since this was the first time we were able to relate amplitudes to a physical location on a detector. This study was done on simulated data sets for which position labels are available. With this premise in mind, the following presentation shows a few major results: [Google slides](https://docs.google.com/presentation/d/1xqKi7aYVW0pN7yqyr33WvaDOcaUctCXSWC3h7KMZtCk/edit?usp=sharing).